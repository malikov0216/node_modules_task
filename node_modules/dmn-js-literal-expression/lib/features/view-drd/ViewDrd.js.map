{"version":3,"sources":["../../../src/features/view-drd/ViewDrd.js"],"names":["ViewDrdComponent","HIGH_PRIORITY","ViewDrd","components","viewer","eventBus","injector","_injector","_viewer","onGetComponent","canViewDrd","on","parent","get","definitions","getDefinitions","view","getView","open","getDecision","$inject","decision","$parent"],"mappings":";;;;AAAA,OAAOA,gBAAP,MAA6B,+BAA7B;;AAEA,IAAMC,gBAAgB,IAAtB;;IAGqBC,O;AAEnB,mBAAYC,UAAZ,EAAwBC,MAAxB,EAAgCC,QAAhC,EAA0CC,QAA1C,EAAoD;AAAA;;AAAA;;AAClD,SAAKC,SAAL,GAAiBD,QAAjB;AACA,SAAKE,OAAL,GAAeJ,MAAf;;AAEAD,eAAWM,cAAX,CAA0B,QAA1B,EAAoCR,aAApC,EAAmD,YAAM;AACvD,UAAI,MAAKS,UAAL,EAAJ,EAAuB;AACrB,eAAOV,gBAAP;AACD;AACF,KAJD;;AAMAK,aAASM,EAAT,CAAY,SAAZ,EAAuB,YAAM;AAC3B,UAAMC,SAASN,SAASO,GAAT,CAAa,SAAb,EAAwB,KAAxB,CAAf;;AAEA;AACA,UAAMC,cAAc,MAAKC,cAAL,EAApB;;AAEA;AACA,UAAMC,OAAOJ,OAAOK,OAAP,CAAeH,WAAf,CAAb;;AAEAF,aAAOM,IAAP,CAAYF,IAAZ;AACD,KAVD;AAWD;;;;iCAEY;AACX,UAAMJ,SAAS,KAAKL,SAAL,CAAeM,GAAf,CAAmB,SAAnB,EAA8B,KAA9B,CAAf;;AAEA,UAAI,CAACD,MAAL,EAAa;AACX;AACD;;AAED;AACA,UAAME,cAAc,KAAKC,cAAL,EAApB;;AAEA,aAAO,CAAC,CAACH,OAAOK,OAAP,CAAeH,WAAf,CAAT;AACD;;;qCAEgB;AACf,aAAOC,gBAAe,KAAKP,OAAL,CAAaW,WAAb,EAAf,CAAP;AACD;;;;;;eAxCkBjB,O;;;AA4CrBA,QAAQkB,OAAR,GAAkB,CAAE,YAAF,EAAgB,QAAhB,EAA0B,UAA1B,EAAsC,UAAtC,CAAlB;;AAGA;;AAEA,SAASL,eAAT,CAAwBM,QAAxB,EAAkC;AAChC,MAAMP,cAAcO,SAASC,OAA7B;;AAEA,SAAOR,WAAP;AACD","file":"ViewDrd.js","sourcesContent":["import ViewDrdComponent from './components/ViewDrdComponent';\r\n\r\nconst HIGH_PRIORITY = 1500;\r\n\r\n\r\nexport default class ViewDrd {\r\n\r\n  constructor(components, viewer, eventBus, injector) {\r\n    this._injector = injector;\r\n    this._viewer = viewer;\r\n\r\n    components.onGetComponent('viewer', HIGH_PRIORITY, () => {\r\n      if (this.canViewDrd()) {\r\n        return ViewDrdComponent;\r\n      }\r\n    });\r\n\r\n    eventBus.on('showDrd', () => {\r\n      const parent = injector.get('_parent', false);\r\n\r\n      // there is only one single element\r\n      const definitions = this.getDefinitions();\r\n\r\n      // open definitions\r\n      const view = parent.getView(definitions);\r\n\r\n      parent.open(view);\r\n    });\r\n  }\r\n\r\n  canViewDrd() {\r\n    const parent = this._injector.get('_parent', false);\r\n\r\n    if (!parent) {\r\n      return;\r\n    }\r\n\r\n    // there is only one single element\r\n    const definitions = this.getDefinitions();\r\n\r\n    return !!parent.getView(definitions);\r\n  }\r\n\r\n  getDefinitions() {\r\n    return getDefinitions(this._viewer.getDecision());\r\n  }\r\n\r\n}\r\n\r\nViewDrd.$inject = [ 'components', 'viewer', 'eventBus', 'injector' ];\r\n\r\n\r\n// helpers //////////////////////\r\n\r\nfunction getDefinitions(decision) {\r\n  const definitions = decision.$parent;\r\n\r\n  return definitions;\r\n}"]}