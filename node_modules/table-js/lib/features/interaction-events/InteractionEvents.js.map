{"version":3,"sources":["../../../src/features/interaction-events/InteractionEvents.js"],"names":["closest","domClosest","EVENTS","InteractionEvents","config","eventBus","_handleEvent","event","target","type","node","findClosestCell","elementId","getAttribute","e","_eventBus","createEvent","id","fire","defaultPrevented","preventDefault","cancelBubble","stopPropagation","_container","container","on","_addEventListeners","_removeEventListeners","events","forEach","addEventListener","removeEventListener","$inject","element"],"mappings":";;;;AAAA,SACEA,WAAWC,UADb,QAEO,SAFP;;AAIA,IAAMC,SAAS,CACb,OADa,EAEb,UAFa,EAGb,aAHa,EAIb,WAJa,EAKb,SALa,EAMb,YANa,EAOb,YAPa,EAQb,UARa,EASb,WATa,EAUb,WAVa,EAWb,SAXa,EAYb,UAZa,EAab,MAba,EAcb,WAda,EAeb,SAfa,EAgBb,UAhBa,EAiBb,WAjBa,EAkBb,WAlBa,EAmBb,MAnBa,CAAf;;AAuBA;;;;;;;IAMqBC,iB;AAEnB,6BAAYC,MAAZ,EAAoBC,QAApB,EAA8B;AAAA;;AAAA;;AAAA,SA6B9BC,YA7B8B,GA6Bf,UAACC,KAAD,EAAW;AAAA,UAChBC,MADgB,GACCD,KADD,CAChBC,MADgB;AAAA,UACRC,IADQ,GACCF,KADD,CACRE,IADQ;;;AAGxB,UAAMC,OAAOC,gBAAgBH,MAAhB,CAAb;;AAEA,UAAI,CAACE,IAAL,EAAW;AACT;AACD;;AAED,UAAME,YAAYF,KAAKG,YAAL,CAAkB,iBAAlB,CAAlB;;AAEA,UAAID,SAAJ,EAAe;AACb,YAAME,IAAI,MAAKC,SAAL,CAAeC,WAAf,CAA2B;AACnCC,cAAIL,SAD+B;AAEnCL,sBAFmC;AAGnCG,oBAHmC;AAInCF,kBAAQE;AAJ2B,SAA3B,CAAV;;AAOA,cAAKK,SAAL,CAAeG,IAAf,WAA4BT,IAA5B,EAAoCK,CAApC;;AAEA,YAAIA,EAAEK,gBAAN,EAAwB;AACtBZ,gBAAMa,cAAN;AACD;;AAED,YAAIN,EAAEO,YAAN,EAAoB;AAClBd,gBAAMe,eAAN;AACD;AACF;AACF,KA1D6B;;AAC5B,SAAKP,SAAL,GAAiBV,QAAjB;AACA,SAAKkB,UAAL,GAAkBnB,OAAOoB,SAAzB;;AAEAnB,aAASoB,EAAT,CAAY,YAAZ,EAA0B,YAAM;AAC9B,YAAKC,kBAAL,CAAwBxB,MAAxB;AACD,KAFD;;AAIAG,aAASoB,EAAT,CAAY,eAAZ,EAA6B,YAAM;AACjC,YAAKE,qBAAL,CAA2BzB,MAA3B;AACD,KAFD;AAGD;;;;uCAEkB0B,M,EAAQ;AAAA;;AACzB,UAAMJ,YAAY,KAAKD,UAAvB;;AAEAK,aAAOC,OAAP,CAAe,iBAAS;AACtBL,kBAAUM,gBAAV,CAA2BvB,KAA3B,EAAkC,OAAKD,YAAvC;AACD,OAFD;AAGD;;;0CAEqBsB,M,EAAQ;AAAA;;AAC5B,UAAMJ,YAAY,KAAKD,UAAvB;;AAEAK,aAAOC,OAAP,CAAe,iBAAS;AACtBL,kBAAUO,mBAAV,CAA8BxB,KAA9B,EAAqC,OAAKD,YAA1C;AACD,OAFD;AAGD;;;;;;eA7BkBH,iB;;;AA+DrBA,kBAAkB6B,OAAlB,GAA4B,CAC1B,iBAD0B,EAE1B,UAF0B,CAA5B;;AAKA;;AAEA,SAASrB,eAAT,CAAyBsB,OAAzB,EAAkC;AAChC,SAAOhC,WAAWgC,OAAX,EAAoB,mBAApB,EAAyC,IAAzC,CAAP;AACD","file":"InteractionEvents.js","sourcesContent":["import {\n  closest as domClosest\n} from 'min-dom';\n\nconst EVENTS = [\n  'click',\n  'dblclick',\n  'contextmenu',\n  'mousedown',\n  'mouseup',\n  'mouseenter',\n  'mouseleave',\n  'mouseout',\n  'mouseover',\n  'mousemove',\n  'focusin',\n  'focusout',\n  'drag',\n  'dragstart',\n  'dragend',\n  'dragover',\n  'dragenter',\n  'dragleave',\n  'drop'\n];\n\n\n/**\n * Provides interaction events on the table.\n *\n * @param {RenderConfig} config\n * @param {EventBus} eventBus\n */\nexport default class InteractionEvents {\n\n  constructor(config, eventBus) {\n    this._eventBus = eventBus;\n    this._container = config.container;\n\n    eventBus.on('table.init', () => {\n      this._addEventListeners(EVENTS);\n    });\n\n    eventBus.on('table.destroy', () => {\n      this._removeEventListeners(EVENTS);\n    });\n  }\n\n  _addEventListeners(events) {\n    const container = this._container;\n\n    events.forEach(event => {\n      container.addEventListener(event, this._handleEvent);\n    });\n  }\n\n  _removeEventListeners(events) {\n    const container = this._container;\n\n    events.forEach(event => {\n      container.removeEventListener(event, this._handleEvent);\n    });\n  }\n\n  _handleEvent = (event) => {\n    const { target, type } = event;\n\n    const node = findClosestCell(target);\n\n    if (!node) {\n      return;\n    }\n\n    const elementId = node.getAttribute('data-element-id');\n\n    if (elementId) {\n      const e = this._eventBus.createEvent({\n        id: elementId,\n        event,\n        node,\n        target: node\n      });\n\n      this._eventBus.fire(`cell.${type}`, e);\n\n      if (e.defaultPrevented) {\n        event.preventDefault();\n      }\n\n      if (e.cancelBubble) {\n        event.stopPropagation();\n      }\n    }\n  }\n}\n\nInteractionEvents.$inject = [\n  'config.renderer',\n  'eventBus'\n];\n\n// helpers /////////////\n\nfunction findClosestCell(element) {\n  return domClosest(element, '[data-element-id]', true);\n}"]}