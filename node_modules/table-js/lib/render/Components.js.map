{"version":3,"sources":["../../src/render/Components.js"],"names":["isFunction","isNumber","DEFAULT_PRIORITY","Components","_listeners","type","context","listeners","component","i","length","callback","components","push","priority","Error","_getListeners","existingListener","idx","newListener","splice","listener","listenerCallback"],"mappings":"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","file":"Components.js","sourcesContent":["import {\n  isFunction,\n  isNumber\n} from 'min-dash';\n\nconst DEFAULT_PRIORITY = 1000;\n\n\nexport default class Components {\n\n  constructor() {\n    this._listeners = {};\n  }\n\n  getComponent(type, context) {\n    const listeners = this._listeners[type];\n\n    if (!listeners) {\n      return;\n    }\n\n    let component;\n\n    for (let i = 0; i < listeners.length; i++) {\n      component = listeners[i].callback(context);\n\n      if (component) {\n        break;\n      }\n    }\n\n    return component;\n  }\n\n  getComponents(type, context) {\n    const listeners = this._listeners[type];\n\n    const components = [];\n\n    if (!listeners) {\n      return components;\n    }\n\n\n    for (let i = 0; i < listeners.length; i++) {\n      const component = listeners[i].callback(context);\n\n      if (component) {\n        components.push(component);\n      }\n    }\n\n    if (!components.length) {\n      return components;\n    }\n\n    return components;\n  }\n\n  onGetComponent(type, priority, callback) {\n    if (isFunction(priority)) {\n      callback = priority;\n      priority = DEFAULT_PRIORITY;\n    }\n\n    if (!isNumber(priority)) {\n      throw new Error('priority must be a number');\n    }\n\n    const listeners = this._getListeners(type);\n\n    let existingListener,\n        idx;\n\n    const newListener = { priority, callback };\n\n    for (idx = 0; (existingListener = listeners[idx]); idx++) {\n      if (existingListener.priority < priority) {\n\n        // prepend newListener at before existingListener\n        listeners.splice(idx, 0, newListener);\n        return;\n      }\n    }\n\n    listeners.push(newListener);\n  }\n\n  offGetComponent(type, callback) {\n    const listeners = this._getListeners(type);\n\n    let listener,\n        listenerCallback,\n        idx;\n\n    if (callback) {\n\n      // move through listeners from back to front\n      // and remove matching listeners\n      for (idx = listeners.length - 1; (listener = listeners[idx]); idx--) {\n        listenerCallback = listener.callback;\n\n        if (listenerCallback === callback) {\n          listeners.splice(idx, 1);\n        }\n      }\n    } else {\n      // clear listeners\n      listeners.length = 0;\n    }\n  }\n\n  _getListeners(type) {\n    let listeners = this._listeners[type];\n\n    if (!listeners) {\n      this._listeners[type] = listeners = [];\n    }\n\n    return listeners;\n  }\n}"]}