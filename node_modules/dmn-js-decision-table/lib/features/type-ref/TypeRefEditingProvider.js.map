{"version":3,"sources":["../../../src/features/type-ref/TypeRefEditingProvider.js"],"names":["closest","domClosest","TypeRefCell","TypeRefCellContextMenu","TypeRef","components","contextMenu","eventBus","renderer","onGetComponent","cellType","context","contextMenuType","on","event","element","target","node","getBoundingClientRect","left","top","width","height","container","getContainer","open","x","parentNode","scrollLeft","y","scrollTop","offset","$inject"],"mappings":";;AAAA,SACEA,WAAWC,UADb,QAEO,SAFP;;AAIA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,OAAOC,sBAAP,MAAmC,qCAAnC;;IAEqBC,O,GAEnB,iBAAYC,UAAZ,EAAwBC,WAAxB,EAAqCC,QAArC,EAA+CC,QAA/C,EAAyD;AAAA;;AAEvDH,aAAWI,cAAX,CAA0B,MAA1B,EAAkC,gBAAkB;AAAA,QAAfC,QAAe,QAAfA,QAAe;;AAClD,QAAIA,aAAa,uBAAb,IACAA,aAAa,wBADjB,EAC2C;AACzC,aAAOR,WAAP;AACD;AACF,GALD;;AAOAG,aAAWI,cAAX,CAA0B,cAA1B,EAA0C,YAAkB;AAAA,QAAjBE,OAAiB,uEAAP,EAAO;;AAC1D,QAAIA,QAAQC,eAAR,IAA2BD,QAAQC,eAAR,KAA4B,eAA3D,EAA4E;AAC1E,aAAOT,sBAAP;AACD;AACF,GAJD;;AAMAI,WAASM,EAAT,CAAY,cAAZ,EAA4B,iBAAwB;AAAA,QAArBC,KAAqB,SAArBA,KAAqB;AAAA,QAAdC,OAAc,SAAdA,OAAc;AAAA,QAC1CC,MAD0C,GAC/BF,KAD+B,CAC1CE,MAD0C;;;AAGlD,QAAMC,OAAOhB,WAAWe,MAAX,EAAmB,IAAnB,EAAyB,IAAzB,CAAb;;AAHkD,gCAKbC,KAAKC,qBAAL,EALa;AAAA,QAK1CC,IAL0C,yBAK1CA,IAL0C;AAAA,QAKpCC,GALoC,yBAKpCA,GALoC;AAAA,QAK/BC,KAL+B,yBAK/BA,KAL+B;AAAA,QAKxBC,MALwB,yBAKxBA,MALwB;;AAOlD,QAAMC,YAAYf,SAASgB,YAAT,EAAlB;;AAEAlB,gBAAYmB,IAAZ,CAAiB;AACfC,SAAGP,OAAOI,UAAUI,UAAV,CAAqBC,UADhB;AAEfC,SAAGT,MAAMG,UAAUI,UAAV,CAAqBG,SAFf;AAGfT,kBAHe;AAIfC;AAJe,KAAjB,EAKG;AACDV,uBAAiB,eADhB;AAEDG,sBAFC;AAGDgB,cAAQ;AACNL,WAAG,CADG;AAENG,WAAG;AAFG;AAHP,KALH;AAaD,GAtBD;AAuBD,C;;eAxCkBzB,O;;;AA4CrBA,QAAQ4B,OAAR,GAAkB,CAChB,YADgB,EAEhB,aAFgB,EAGhB,UAHgB,EAIhB,UAJgB,CAAlB","file":"TypeRefEditingProvider.js","sourcesContent":["import {\n  closest as domClosest\n} from 'min-dom';\n\nimport TypeRefCell from './components/TypeRefCell';\nimport TypeRefCellContextMenu from './components/TypeRefCellContextMenu';\n\nexport default class TypeRef {\n\n  constructor(components, contextMenu, eventBus, renderer) {\n\n    components.onGetComponent('cell', ({ cellType }) => {\n      if (cellType === 'input-header-type-ref' ||\n          cellType === 'output-header-type-ref') {\n        return TypeRefCell;\n      }\n    });\n\n    components.onGetComponent('context-menu', (context = {}) => {\n      if (context.contextMenuType && context.contextMenuType === 'type-ref-edit') {\n        return TypeRefCellContextMenu;\n      }\n    });\n\n    eventBus.on('typeRef.edit', ({ event, element }) => {\n      const { target } = event;\n\n      const node = domClosest(target, 'th', true);\n\n      const { left, top, width, height } = node.getBoundingClientRect();\n\n      const container = renderer.getContainer();\n\n      contextMenu.open({\n        x: left + container.parentNode.scrollLeft,\n        y: top + container.parentNode.scrollTop,\n        width,\n        height\n      }, {\n        contextMenuType: 'type-ref-edit',\n        element,\n        offset: {\n          x: 4,\n          y: 4\n        }\n      });\n    });\n  }\n\n}\n\nTypeRef.$inject = [\n  'components',\n  'contextMenu',\n  'eventBus',\n  'renderer'\n];"]}