{"version":3,"sources":["../../../../src/features/allowed-values/behavior/AllowedValuesUpdateBehavior.js"],"names":["CommandInterceptor","is","isInput","AllowedValuesUpdateBehavior","eventBus","modeling","postExecuted","event","context","element","properties","actualProperties","inputExpression","typeRef","target","$parent","editAllowedValues","$inject"],"mappings":";;;;;;AAAA,OAAOA,kBAAP,MAA+B,2CAA/B;;AAEA,SAASC,EAAT,EAAaC,OAAb,QAA4B,kCAA5B;;AAEA;;;;;IAIqBC,2B;;;AAEnB,uCAAYC,QAAZ,EAAsBC,QAAtB,EAAgC;AAAA;;AAAA,0JACxBD,QADwB;;AAG9B,UAAKE,YAAL,CAAkB,kBAAlB,EAAsC,iBAAS;AAAA,2BAIzCC,MAAMC,OAJmC;AAAA,UAE3CC,OAF2C,kBAE3CA,OAF2C;AAAA,UAG3CC,UAH2C,kBAG3CA,UAH2C;;;AAM7C,UAAMC,mBAAmBT,QAAQO,OAAR,IAAmBC,WAAWE,eAA9B,GAAgDF,UAAzE;;AAEA,UAAIC,oBACCA,iBAAiBE,OADlB,IAECF,iBAAiBE,OAAjB,KAA6B,QAFlC,EAE4C;;AAE1C,YAAMC,SACJb,GAAGQ,OAAH,EAAY,uBAAZ,IACEA,QAAQM,OADV,GAEEN,OAHJ;;AAMA;AACAJ,iBAASW,iBAAT,CAA2BF,MAA3B,EAAmC,IAAnC;AACD;AACF,KArBD;AAH8B;AAyB/B;;;EA3BsDd,kB;;eAApCG,2B;;;AA8BrBA,4BAA4Bc,OAA5B,GAAsC,CACpC,UADoC,EAEpC,UAFoC,CAAtC","file":"AllowedValuesUpdateBehavior.js","sourcesContent":["import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is, isInput } from 'dmn-js-shared/lib/util/ModelUtil';\n\n/**\n * Makes sure allowed values are removed if type is set to\n * something other than string.\n */\nexport default class AllowedValuesUpdateBehavior extends CommandInterceptor {\n\n  constructor(eventBus, modeling) {\n    super(eventBus);\n\n    this.postExecuted('updateProperties', event => {\n      const {\n        element,\n        properties\n      } = event.context;\n\n      const actualProperties = isInput(element) ? properties.inputExpression : properties;\n\n      if (actualProperties\n        && actualProperties.typeRef\n        && actualProperties.typeRef !== 'string') {\n\n        const target = (\n          is(element, 'dmn:LiteralExpression') ?\n            element.$parent :\n            element\n        );\n\n        // delete allowed values\n        modeling.editAllowedValues(target, null);\n      }\n    });\n  }\n}\n\nAllowedValuesUpdateBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];"]}