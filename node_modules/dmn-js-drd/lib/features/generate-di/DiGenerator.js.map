{"version":3,"sources":["../../../src/features/generate-di/DiGenerator.js"],"names":["forEach","containsDi","is","DiGenerator","eventBus","drdFactory","elementFactory","on","definitions","createDi","idx","drgElements","element","bounds","extensionElements","dimensions","$parent","_getDefaultSize","createDiBounds","x","y","width","height","get","push","$inject"],"mappings":"AAAA,SAASA,OAAT,QAAwB,UAAxB;;AAEA,SAASC,UAAT,QAA2B,+BAA3B;AACA,SAASC,EAAT,QAAmB,kCAAnB;;AAGA;;;;;;;;;AASA,eAAe,SAASC,WAAT,CAAqBC,QAArB,EAA+BC,UAA/B,EAA2CC,cAA3C,EAA2D;;AAExE;AACAF,WAASG,EAAT,CAAY,cAAZ,EAA4B,gBAAqB;AAAA,QAAlBC,WAAkB,QAAlBA,WAAkB;;AAC/C,QAAI,CAACP,WAAWO,WAAX,CAAL,EAA8B;AAC5BC,eAASD,WAAT;AACD;AACF,GAJD;;AAOA;;;AAGA,WAASC,QAAT,CAAkBD,WAAlB,EAA+B;;AAE7B,QAAIE,MAAM,CAAV;;AAEAV,YAAQQ,YAAYG,WAApB,EAAiC,UAASC,OAAT,EAAkB;;AAEjD,UAAIC,MAAJ,EACIC,iBADJ,EAEIC,UAFJ;;AAIA;AACA;AACA,UAAI,CAACb,GAAGU,OAAH,EAAY,cAAZ,CAAL,EAAkC;AAChC;AACD;;AAEDE,0BAAoBF,QAAQE,iBAA5B;;AAEA,UAAI,CAACA,iBAAL,EAAwB;AACtBA,4BAAoBF,QAAQE,iBAAR,GAA4BT,WAAWI,QAAX,EAAhD;AACAK,0BAAkBE,OAAlB,GAA4BJ,OAA5B;AACD;;AAEDG,mBAAaT,eAAeW,eAAf,CAA+BL,OAA/B,CAAb;;AAEAC,eAASR,WAAWa,cAAX,CAA0B;AACjCC,WAAG,MAAOT,MAAM,EADiB;AAEjCU,WAAG,MAAOV,MAAM,EAFiB;AAGjCW,eAAON,WAAWM,KAHe;AAIjCC,gBAAQP,WAAWO;AAJc,OAA1B,CAAT;;AAOA;AACAR,wBAAkBS,GAAlB,CAAsB,QAAtB,EAAgCC,IAAhC,CAAqCX,MAArC;AACAA,aAAOG,OAAP,GAAiBF,iBAAjB;;AAEA;AACAJ;AACD,KAlCD;AAmCD;AAEF;;AAGDP,YAAYsB,OAAZ,GAAsB,CACpB,UADoB,EAEpB,YAFoB,EAGpB,gBAHoB,CAAtB","file":"DiGenerator.js","sourcesContent":["import { forEach } from 'min-dash';\n\nimport { containsDi } from 'dmn-js-shared/lib/util/DiUtil';\nimport { is } from 'dmn-js-shared/lib/util/ModelUtil';\n\n\n/**\n * A component that generated basic DI, if graphical\n * information is missing on a dmn:Definitions element\n * to be imported.\n *\n * @param {EventBus} eventBus\n * @param {DrdFactory} drdFactory\n * @param {ElementFactory} elementFactory\n */\nexport default function DiGenerator(eventBus, drdFactory, elementFactory) {\n\n  // ensure the definitions contains DI information\n  eventBus.on('import.start', ({ definitions }) => {\n    if (!containsDi(definitions)) {\n      createDi(definitions);\n    }\n  });\n\n\n  /**\n   * Create basic DI for given dmn:Definitions element\n   */\n  function createDi(definitions) {\n\n    var idx = 0;\n\n    forEach(definitions.drgElements, function(element) {\n\n      var bounds,\n          extensionElements,\n          dimensions;\n\n      // only create DI for decision elements;\n      // we're not a full fledged layouter (!)\n      if (!is(element, 'dmn:Decision')) {\n        return;\n      }\n\n      extensionElements = element.extensionElements;\n\n      if (!extensionElements) {\n        extensionElements = element.extensionElements = drdFactory.createDi();\n        extensionElements.$parent = element;\n      }\n\n      dimensions = elementFactory._getDefaultSize(element);\n\n      bounds = drdFactory.createDiBounds({\n        x: 150 + (idx * 30),\n        y: 150 + (idx * 30),\n        width: dimensions.width,\n        height: dimensions.height\n      });\n\n      // add bounds\n      extensionElements.get('values').push(bounds);\n      bounds.$parent = extensionElements;\n\n      // stacking elements nicely on top of each other\n      idx++;\n    });\n  }\n\n}\n\n\nDiGenerator.$inject = [\n  'eventBus',\n  'drdFactory',\n  'elementFactory'\n];"]}